<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G.O.E | One State RP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --font-main: 'Inter', sans-serif;
            --font-classic: 'Roboto Slab', serif;
            --color-primary-500: #6d28d9; --color-primary-600: #5b21b6; --color-primary-700: #4c1d95;
            --color-accent-300: #a78bfa; --color-accent-400: #8b5cf6;
        }
        .theme-purple { --color-primary-500: #6d28d9; --color-primary-600: #5b21b6; --color-primary-700: #4c1d95; --color-accent-300: #a78bfa; --color-accent-400: #8b5cf6; }
        .theme-blue { --color-primary-500: #2563eb; --color-primary-600: #1d4ed8; --color-primary-700: #1e40af; --color-accent-300: #93c5fd; --color-accent-400: #60a5fa; }
        .theme-green { --color-primary-500: #16a34a; --color-primary-600: #15803d; --color-primary-700: #166534; --color-accent-300: #86efac; --color-accent-400: #4ade80; }
        .theme-red { --color-primary-500: #dc2626; --color-primary-600: #b91c1c; --color-primary-700: #991b1b; --color-accent-300: #fca5a5; --color-accent-400: #f87171; }

        body { font-family: var(--font-main); }
        .font-classic { font-family: var(--font-classic); }
        .bg-primary-600 { background-color: var(--color-primary-600); }
        .hover\:bg-primary-700:hover { background-color: var(--color-primary-700); }
        .text-accent-400 { color: var(--color-accent-400); }
        .ring-accent-400:focus { --tw-ring-color: var(--color-accent-400); }
        .border-accent-400 { border-color: var(--color-accent-400); }
        .text-accent-300 { color: var(--color-accent-300); }

        .page-content, .question-step { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        #questionnaire-modal, #nickname-modal { backdrop-filter: blur(10px); }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1f2937; }
        ::-webkit-scrollbar-thumb { background: var(--color-primary-600); border-radius: 10px; }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; background: #000; border-radius: 0.5rem;}
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <!-- Modal do Questionário -->
    <div id="questionnaire-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black bg-opacity-70 p-4">
        <div id="questionnaire-card" class="bg-gray-800 p-8 rounded-lg shadow-2xl w-full max-w-lg text-center transition-all duration-500"></div>
    </div>

    <!-- Modal de Apelido -->
    <div id="nickname-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black bg-opacity-70">
        <div class="bg-gray-800 p-8 rounded-lg shadow-2xl w-11/12 max-w-md text-center">
            <h2 class="text-2xl font-bold text-accent-400 mb-4">Identifique-se, Agente</h2>
            <p class="text-gray-300 mb-6">Insira seu apelido (nome no RP) para acessar a plataforma.</p>
            <form id="nickname-form">
                <input type="text" id="nickname-input-modal" placeholder="Seu apelido" class="w-full bg-gray-700 text-white p-3 rounded-md border border-gray-600 focus:ring-2 ring-accent-400 focus:outline-none mb-4" required>
                <button type="submit" class="w-full bg-primary-600 hover:bg-primary-700 text-white font-bold py-3 rounded-lg transition-colors">Entrar na Plataforma</button>
            </form>
        </div>
    </div>

    <!-- App Principal (inicialmente oculto) -->
    <div id="app-container" class="hidden">
        <div class="flex">
            <aside id="sidebar" class="bg-gray-900 text-white w-64 fixed top-0 left-0 h-full z-40 transform -translate-x-full transition-transform duration-300 ease-in-out md:relative md:translate-x-0 md:flex md:flex-col">
                <div class="flex items-center justify-between p-4 border-b border-gray-700 md:hidden">
                    <h2 class="text-lg font-bold text-accent-400">Menu</h2>
                    <button id="close-sidebar-btn">&times;</button>
                </div>
                <nav id="nav-menu" class="flex-grow p-4"></nav>
                <div class="p-4 border-t border-gray-700 text-xs text-center text-gray-500">Plataforma G.O.E v5.1</div>
            </aside>
            <div class="flex-1 flex flex-col min-h-screen">
                <header class="bg-gray-800 bg-opacity-80 backdrop-blur-md text-white shadow-lg sticky top-0 z-30 flex items-center justify-between p-4">
                     <div class="flex items-center">
                        <button id="open-sidebar-btn" class="mr-4 text-white md:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y2="12"></line><line x1="4" x2="20" y2="6"></line><line x1="4" x2="20" y2="18"></line></svg>
                        </button>
                        <h1 class="text-xl md:text-2xl font-bold tracking-wider">
                            <span class="text-accent-400">G.O.E</span> <span class="font-light text-gray-300">| One State</span>
                        </h1>
                    </div>
                    <div id="user-display" class="flex items-center space-x-2 text-sm text-accent-300">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                        <span id="user-nickname"></span>
                    </div>
                </header>
                <main id="main-content" class="flex-grow"></main>
            </div>
            <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 md:hidden hidden"></div>
        </div>
    </div>

    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const icons = { macros: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="12" y1="3" x2="12" y2="21"></line><line x1="3" x2="21" y2="12"></line></svg>`, book: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>`, quiz: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path><path d="m9 12 2 2 4-4"></path></svg>`, ai: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 8V4H8"></path><path d="M12 16h4"></path><path d="M12 12h2"></path><path d="M20 12c0-4.42-3.58-8-8-8s-8 3.58-8 8 3.58 8 8 8v0c4.42 0 8-3.58 8-8Z"></path><path d="M18 18a4 4 0 0 0-4-4"></path></svg>`, settings: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>`, copy: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>`, send: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>`, tutorial: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 14 4-4-4-4m-4 8 4-4-4-4"/><path d="M3 3v18h18"/></svg>`};
            const
studyMaterialData = { "sumario": ["Regras da Polícia", "Violações", "Códigos Q", "Códigos de Patrulha", "Zonas", "Uso de Fuzil", "VTR de Farm", "Funções dos Oficiais na VTR", "Abreviações de Patentes & Carreira Policial", "Regras Internas da DP", "Regras do Role Play"], "Regras da Polícia": { title: "Regras da Polícia", content: [{ subtitle: "Falsas Acusações", text: "É PROIBIDO LEVANTAR FALSAS ACUSAÇÕES CONTRA CIVIS. QUALQUER POLICIAL QUE ALGEMAR, ATIRAR, SOLTAR TASER OU APRISIONAR QUALQUER CIDADÃO SEM UMA ACUSAÇÃO SÓLIDA SERÁ REMOVIDO DA CORPORAÇÃO." }, { subtitle: "Detenção Sem Causa", text: "É PROIBIDO DETER OU APRISIONAR QUALQUER CIDADÃO SEM CAUSA PARA ISSO. O POLICIAL QUE O FIZER SERÁ REMOVIDO DA CORPORAÇÃO." }, { subtitle: "Atitude Desrespeitosa", text: "ATITUDE DESRESPEITOSA COM COLEGAS E CIVIS NÃO É ACEITÁVEL. NÃO SEJA RUDE, NÃO INSULTE E NÃO SEJA DE MANEIRA NENHUMA INTOLERANTE. (PENALIDADE: 1ª REPREENSÃO)." }, { subtitle: "Uso de Armamentos", text: "O USO DE ARMAMENTOS, FORÇA FÍSICA E/OU EQUIPAMENTO ESPECIAL SEM AVISO PRÉVIO OU UMA RAZÃO JUSTIFICÁVEL DENTRO DO ROLEPLAY É PROIBIDO.\nRAZÕES JUSTIFICÁVEIS:\n- DETENÇÃO DE UM CRIMINOSO PROCURADO POR CRIMES IDENTIFICADOS PELO SISTEMA.\n- RESISTÊNCIA À PRISÃO.\n- COLOCAR EM RISCO A INTEGRIDADE FÍSICA OU A VIDA DE UM POLICIAL OU DE UM CIVIL.\n- PERSEGUIÇÃO POLICIAL.\nPENALIDADE: (1ª REPREENSÃO) E, EM CASOS MAIS GRAVES, REMOÇÃO DA CORPORAÇÃO." }, { subtitle: "Violação das Regras do Servidor", text: "É PROIBIDO VIOLAR AS REGRAS DO SERVIDOR. A PUNIÇÃO PARA TAL VIOLAÇÃO SERÁ (1ª REPREENSÃO), ALÉM DE UMA PUNIÇÃO REFERENTE À VIOLAÇÃO COMETIDA." }, { subtitle: "Uso Indevido dos Veículos da Corporação", text: "USAR OS VEÍCULOS DA CORPORAÇÃO PARA BENEFÍCIO PESSOAL É ESTRITAMENTE PROIBIDO. A PENALIDADE PARA ESSE ATO É (1ª REPREENSÃO)." }, { subtitle: "Insultos à Liderança", text: "INSULTOS DIRIGIDOS À LIDERANÇA DA CORPORAÇÃO RESULTARÃO EM (1ª REPREENSÃO)." }, { subtitle: "Passos Obrigatórios ao Apreender Alguém", text: "O POLICIAL DEVE EXPLICAR DE FORMA CLARA A RAZÃO DA APREENSÃO. AO APREENDER ALGUÉM, O POLICIAL DEVE ORDENAR QUE O CIDADÃO PARE O QUE ESTÁ FAZENDO, SEJA ANDANDO OU DIRIGindo. EM CASO DE NÃO OBEDIÊNCIA, O USO DO TASER É PERMITIDO. MATAR ALGUÉM QUE NÃO OFERECE RISCOS É ETERNAMENTE PROIBIDO." }, { subtitle: "Uso de Veículo Pessoal para Atividades Policiais", text: "É PROIBIDO USAR VEÍCULO PESSOAL PARA REALIZAR AS ATIVIDADES POLICIAIS. A PENALIDADE PARA ESSA INFRAÇÃO SERÁ (1ª REPREENSÃO) E, EM CASO DE REINCIDÊNCIA, A EXPULSÃO DA CORPORAÇÃO." }] }, "Violações": { title: "Violações", content: [{ subtitle: "Violações Administrativas", text: "5 MINUTOS DE PRISÃO (PODE APLICAR A PARTIR DE RECRUTA)\nPROIBIDO: PRISÃO DE 5 MINUTOS DA VIOLAÇÃO 3.4\n3.1 RESISTÊNCIA À PRISÃO.\n3.2 DESACATO À AUTORIDADE.\n3.3 AUXÍLIO À RESISTÊNCIA À PRISÃO.\n3.4 INFRAÇÕES DAS LEIS DE TRÂNSITO.\n3.5 ATAQUE A CIVIS.\n3.6 RECUSA EM APRESENTAR DOCUMENTOS SOLICITADOS." }, { subtitle: "Violações Civis", text: "10 MINUTOS DE PRISÃO (PODE APLICAR A PARTIR DE 1º SARGENTO)\n2.1 DANOS À PROPRIEDADE PÚBLICA.\n2.2 DANOS À PROPRIEDADE PRIVADA.\n2.3 TROTES PARA A POLÍCIA OU IDENTIDADE FALSA.\n2.4 ARRUAÇA.\n2.5 AMEAÇA DE ASSASSINATO, TENTATIVA DE ASSASSINATO E ASSASSINATO.\n2.6 INSULTO A FUNCIONÁRIO PÚBLICO.\n2.7 EXTORSÃO." }, { subtitle: "Violações Criminais", text: "20 MINUTOS DE PRISÃO (PODE APLICAR A PARTIR DE TENENTE)\n1.1 CAPTURA DAS INSTITUIÇÕES PÚBLICAS (PROTESTO EM LOCAL PÚBLICO - DP, HP, ETC).\n1.2 TOMADA DO PODER PELA FORÇA.\n1.3 TOMADA DE REFÉNS OU SEQUESTRO.\n1.4 COLISÃO FATAL COM PEDESTRE (VDM - SEGUIDO DE MORTE).\n1.5 ROUBO/TENTATIVA DE ROUBO.\n1.6 ROUBO A UM POLICIAL.\n1.7 ENTRADA NÃO AUTORIZADA EM UM TERRITÓRIO PROTEGIDO POR LEI.\n1.8 COLISÃO COM PEDESTRE (COLISÃO SEM HAVER MORTE).\n1.9 DISPARO DE ARMA DE FOGO EM LOCAL PÚBLICO, INCLUINDO TAMBÉM O PORTE ILEGAL DE ARMAS.\n1.10 SUBORNO A UM POLICIAL (TENTATIVA DE SUBORNO)." }, { subtitle: "Proibido Aplicação (Próprio Estado Aplica)", text: "1.11 ASSASSINATO DE CIVIL OU POLICIAL.\n1.12 ATAQUE A UM POLICIAL (VIOLÊNCIA).\nATENÇÃO!!! APLICAÇÃO DE VIOLAÇÃO: AO APLICAR AS INFRAÇÕES, É NECESSÁRIO IDENTIFICAR O TIPO DE VIOLAÇÃO, NUMERAR CORRETAMENTE E COLOCAR A DESCRIÇÃO." }] }, "Códigos Q": { title: "Códigos Q", content: [{ text: "OS CÓDIGOS Q REPRESENTAM NOSSA FORMA DE COMUNICAÇÃO, ONDE CADA CÓDIGO POSSUI UM SIGNIFICADO ESPECÍFICO. VEJA ABAIXO:\n- QAP - NA ESCUTA\n- QRR - APOIO TERRESTRE\n- QRL- OCUPADO\n- QRU - OCORRÊNCIA\n- QRV - AS SUAS ORDENS\n- QSJ-DINHEIRO\n- QSL-COMPREENDIDO\n- QTA - CANCELAR\n- QTH - LOCALIZAÇÃO FIXA OU DE MOMENTO\n- QTI - DESTINO OU RUMO\n- TKS OBRIGADO\n- QTX-SAIREI POR TEMPO INDETERMINADO\n- QRX - AGUARDEM\n- QSD-MOTORISTA\n- QRA - NOME OU PATENTE\n- QRG - REGISTRO, EVIDÊNCIA, PROVA, GRAVAÇÃO DE TELA\n- QRV-VIATURA\n- PTR - PATRULHAMENTO OU RONDA\n\nSEMPRE QUE FOR UTILIZAR OS CÓDIGOS Q, É NECESSÁRIO INSERIR NO CHAT/FLOBBY PARA QUE SUA MENSAGEM POSSA SER VISUALIZADA PELA SUA EQUIPE DA CORPORAÇÃO." }] }, "Códigos de Patrulha": { title: "Códigos de Patrulha", content: [{ text: "OS CÓDIGOS A SEGUIR APRESENTAM OS CÓDIGOS DE PATRULHAMENTO, QUE SÃO UMA FORMA DE COMUNICAÇÃO UTILIZADA NA CORPORAÇÃO PARA GARANTIR A EFICIÊNCIA DAS OPERAÇÕES.\n\nCÓDIGO 0 - EM PATRULHA\nCÓDIGO 1 - QRR CONTROLADO\nCÓDIGO 2 - BAIXA INTENSIDADE\nCÓDIGO 3 - MÉDIA INTENSIDADE\nCÓDIGO 4 - ALTA INTENSIDADE\nCÓDIGO 5 - QTH SOBRE FOGO ABERTO (SOLICITAÇÕES DE TODAS AS UNIDADES)\nCÓDIGO 6-A CAMINHO DO QTH PARA VERIFICAÇÃO (USO EXCLUSIVO DAS OPERACIONAIS)\nCÓDIGO 7 - APOIO APENAS ÀS OPERACIONAIS" }] }, "Zonas": { title: "Zonas", content: [{ subtitle: "Zona Verde", text: "CONSIDERADAS ÁREAS (SAFES), ONDE É PROIBIDO QUALQUER ARMAMENTO DE FOGO; SOMENTE O USO DE TASER É LIBERADO." }, { subtitle: "Zona Branca", text: "AONDE OS CIDADÃOS CONSEGUEM UTILIZAR ARMAMENTOS E RECEBE VIOLAÇÕES. ALGUNS LOCAIS, COMO PRAÇAS E REGIÕES CENTRAIS, NÃO PERMITEM O USO DE ARMAS DE GRANDE CALIBRE, COMO POR EXEMPLO, FUZIL." }, { subtitle: "Zona Amarela", text: "LOCAIS DE EVENTOS (PORTO E EXÉRCITO). NÃO É PERMITIDO TRABALHOS POLICIAIS DURANTE OS HORÁRIOS DE EVENTOS, EXCETO O EXÉRCITO, QUANDO SOLICITADO APOIO." }, { subtitle: "Zona Vermelha", text: "ÁREAS PRÓXIMAS AOS QG'S. OS INFRATORES NÃO RECEBEM VIOLAÇÕES DO ESTADO NESSAS ÁREAS. NO ENTANTO, NÃO PODEMOS APLICAR A 1.11 E 1.12; AS DEMAIS SÃO LIBERADAS, CASO O MELIANTE SEJA CAPTURADO." }] }, "Uso de Fuzil": { title: "Uso do Fuzil", content: [{ subtitle: "Situação 1", text: "POLICIAIS EM NÚMERO VANTAJOSO, É OBRIGATÓRIO O USO DO TASER QUANDO O CIDADÃO FUGIR OU NÃO OBEDECER À ORDEM DE PARADA, ETC." }, { subtitle: "Situação 2", text: "COM NÚMEROS APROXIMADAMENTE IGUAIS, O MAIS INDICADO É O USO DO TASER EM CASOS DE DESACATO... EM CASOS DE RISCO EXTREMO (INÍCIO DE FOGO ABERTO), É PERMITIDO O USO DE FUZIL." }, { subtitle: "Situação 3", text: "COM NÚMERO INFERIOR DE OFICIAIS E INÍCIO DE FOGO ABERTO POR CIVIS/FACCIONADOS, É PERMITIDO O USO DE FUZIL, RESPEITANDO SEMPRE AS ÁREAS VERDES!" }, { subtitle: "OBS", text: "O USO DE FUZIL SÓ É LIBERADO NO CENTRO (EM AÇÃO), CASO OS MELIANTES UTILIZEM O MESMO ARMAMENTO CONTRA A GUARNIÇÃO." }] }, "VTR de Farm": { title: "VTR de Farm", content: [{ subtitle: "Velocidade", text: "CENTRO: MÁXIMO 100KM\nSAN PEDRO: 150KM\nDELEGACIA: 15KM" }, { subtitle: "Proibido", text: "ABORDAR DURANTE O FARM (REGRA DO SURDO, MUDO E CEGO! NÃO PARA PARA NADA)." }, { subtitle: "Obrigatório", text: "PISCA-ALERTA E FAROL LIGADO DURANTE O FARM." }, { subtitle: "Farm por Patentes", text: "PATRULHA: A PARTIR DE RECRUTA\nCONTRABANDO: A PARTIR DE SGT-MOR" }] }, "Funções dos Oficiais na VTR": { title: "Funções dos Oficiais na VTR", content: [{ subtitle: "P1 (Condutor/Líder da Patrulha)", text: "RESPONSÁVEL POR DIRIGIR A VIATURA E CONDUZIR A EQUIPE DURANTE A PATRULHA.\nTOMA DECISÕES TÁTICAS E ESTRATÉGICAS DURANTE A OPERAÇÃO.\nDÁ ORDENS AOS DEMAIS MEMBROS DA EQUIPE E MANTÉM CONTATO COM A CENTRAL." }, { subtitle: "P2 (Navegador/Rádio Operador)", text: "AUXILIA O P1 NA NAVEGAÇÃO E COMUNICAÇÃO COM A CENTRAL DE POLÍCIA.\nINFORMA A LOCALIZAÇÃO E POSSÍVEIS SITUAÇÕES DE RISCO.\nANOTA INFORMAÇÕES RELEVANTES, COMO PLACAS DE VEÍCULOS SUSPEITOS." }, { subtitle: "P3 (Segurança/Lado Direito)", text: "POSICIONADO NO BANCO TRASEIRO ESQUERDO DA VIATURA.\nRESPONSÁVEL POR COBRIR O LADO ESQUERDO DURANTE ABORDAGENS.\nDÁ SUPORTE AO P1 E P2 EM SITUAÇÕES EMERGENCIAIS." }, { subtitle: "P4 (Apoio/Lado Esquerdo)", text: "POSICIONADO NO BANCO TRASEIRO DIREITO DA VIATURA.\nCOBRE O LADO DIREITO DURANTE ABORDAGENS.\nAUXILIA NO CONTROLE DE SUSPEITOS E PROTEÇÃO DA EQUIPE." }] }, "Abreviações de Patentes & Carreira Policial": { title: "Abreviações de Patentes & Carreira Policial", content: [{ subtitle: "Abreviações de Patentes", text: "[GEN-FED] GENERAL FEDERAL\n[GEN-ADJ] GENERAL ADJUNTO\n[CEL-GEN] CORONEL GENERAL\n[TEN-GEN] TENENTE GENERAL\n[MAJ-GEN] MAJOR GENERAL\n[CEL] CORONEL\n[MAJ] MAJOR\n[CAP] CAPITÃO\n[TEN] TENENTE\n[SGT-MOR] SARGENTO MOR\n[1° SGT] PRIMEIRO SARGENTO\n[SGT] SARGENTO\n[SD] SOLDADO\n[REC] RECRUTA" }, { subtitle: "Carreira Policial - Requisitos para Tenente", text: "PASSAR NA PROVA PARA TENENTE\n\nTENENTE: OFICIAL QUE EXERCE FUNÇÕES DE COMANDO E SUPERVISÃO. O TENENTE DESEMPENHA UM PAPEL CRUCIAL NA FORMAÇÃO E NO TREINAMENTO DE OUTROS POLICIAIS (DE RECRUTAS A SARGENTOS-MOR), GARANTINDO QUE ESTEJAM PREPARADOS PARA ASSUMIR SUAS FUTURAS RESPONSABILIDADES." }, { subtitle: "Requisitos para Capitão", text: "ENVIAR MACROS/MATERIAL DE ESTUDO PARA OS NOVOS RECRUTAS.\nAPLICAR 10 TREINAMENTOS DE ABORDAGENS.\nAPLICAR 5 AULÕES DE RECRUTAMENTO.\nRECRUTAR E FORMAR 3 NOVOS OFICIAIS.\nVERIFICAR SE OS RECRUTAS ESTÃO COM MACROS.\nLEVAR RECRUTAS PARA A RUA.\nPARTICIPAR DAS REUNIÕES E TREINAMENTOS DE EQUIPES.\nFORMAR OUTROS 5 TENENTES.\n\nCAPITÃO: É O OFICIAL RESPONSÁVEL POR LIDERAR, TREINAR E MANTER A DISCIPLINA DA EQUIPE, ALÉM DE SUPERVISIONAR SE OS TENENTES ESTÃO CUMPRINDO ADEQUADAMENTE SUAS FUNÇÕES." }, { subtitle: "Requisitos para Major", text: "ACOMPANHAR AULÕES DE RECRUTAMENTO.\nREALIZAR 10 AVALIAÇÕES PÓS-RECRUTAMENTO.\nAPLICAR 10 AULAS DE RECRUTAMENTO.\nPARTICIPAR DAS REUNIões E TREINAMENTOS DA EQUIPE.\nRECRUTAR E FORMAR 5 NOVOS OFICIAIS.\nORGANIZAR 1 TREINAMENTO TÁTICO PARA A EQUIPE.\nACOMPANHAR O TRABALHO DOS TENENTES.\n\nMAJOR: OFICIAL QUE VERIFICA EM CAMPO SE TODAS AS UNIDADES ESTÃO ATUANDO CONFORME AS ORDENS RECEBIDAS. TAMBÉM É RESPONSÁVEL POR LIDERAR E COORDENAR OPERAÇÕES POLICIAIS NAS RUAS, GARANTINDO A MANUTENÇÃO DA ORDEM NA AUSÊNCIA DE SEUS SUPERIORES." }, { subtitle: "Requisitos para Coronel", text: "PROMOVER 5 RECRUTAMENTOS DO INÍCIO AO FIM.\nRECRUTAR E FORMAR 10 NOVOS OFICIAIS.\nPARTICIPAR DAS REUNIÕES E TREINAMENTOS DA EQUIPE.\nORGANIZAR 3 TREINAMENTOS TÁTICOS PARA A EQUIPE.\nVISTORIAR O TRABALHO DOS CAPITÃES.\nASSUMIR O CARGO DE AUXILIAR DE TURNO.\n\nCORONEL: O CORONEL DA POLÍCIA É UM OFICIAL DE ALTA PATENTE, COM RESPONSABILIDADES DE LIDERANÇA NA AUSÊNCIA DOS DEMAIS COMANDANTES. ELE GERENCIA OS TURNOS, ORGANIZA A EQUIPE, SOLUCIONA PROBLEMAS, ENTRE OUTRAS FUNÇÕES.\nREQUISITOS IMPORTANTES PARA ESSA PATENTE:\n- ASSUMIR A LIDERANÇA DE UM TURNO.\n- TER RESPONSABILIDADE PELA EQUIPE NA AUSÊNCIA DA LIDERANÇA, ORGANIZAÇÃO ETC.\n- PREPARAR OFICIAIS COM SIMULADOS.\n- REPASSAR FEEDBACKS IMPORTANTES PARA A LIDERANÇA." }] }, "Regras Internas da DP": { title: "Regras Internas da DP", content: [{ subtitle: "Prisões, Violações e Cela", text: "PROIBIDO FICAR DENTRO DAS CELAS, A NÃO SER PARA EFETUAR UMA PRISÃO.\nPROIBIDO EFETUAR PRISÃO ADMINISTRATIVA DA VIOLAÇÃO 3.4 (NO CASO \"DEIXE SE ENTREGAR\").\nPROIBIDO APLICAR VIOLAÇÕES SEM DESCRIÇÃO.\nPROIBIDO PRENDER POR [BUG] NA ABA DE [PRISÃO] QUANDO ESTÁ NA CARCERAGEM.\nPROIBIDO APLICAR VIOLAÇÃO [1.12] E [1.11], AS MESMAS JÁ SÃO APLICADAS PELO ESTADO!\nPUNIÇÃO: REPREENSÃO VERBAL. EM CASOS DE PERSISTÊNCIA, (1ª REPREENSÃO). E PARA VIOLAÇÕES SEM DESCRIÇÃO: REBAIXAMENTO." }, { subtitle: "Farm Policial", text: "PROIBIDO SAIR E DEIXAR O JOGO ABERTO PARA CAIR SALÁRIO INFINITAMENTE.\nPUNIÇÃO: (1ª REPREENSÃO E BANIMENTO DE 3 DIAS APLICADO PELA ADMINISTRAÇÃO (ABUSE 3).\nPROIBIDO SAIR PARA FARMAR E FAZER ABORDAGEM OU TROCAR PAPO.\nPUNIÇÃO: ORIENTAÇÃO. EM CASOS DE PERSISTÊNCIA, (1ª REPREENSÃO)." }, { subtitle: "Armamento Policial", text: "PROIBIDO FICAR DE BRINCADEIRA COM TASER, INCLUINDO ALGEMA E CACETETE.\nPUNIÇÃO: (1ª REPREENSÃO), EM CASOS DE PERSISTÊNCIA EXONERAÇÃO.\nPROIBIDO USAR O TASER SEM MOTIVO.\nPUNIÇÃO: (1ª REPREENSÃO).\nPROIBIDO USAR O TASER E MATAR COM O SUSPEITO NO CHÃO.\nPUNIÇÃO: EXONERAÇÃO (RP13).\nPROIBIDO USAR O TASER MAIS DE DUAS VEZES NA MESMA PESSOA.\nPUNIÇÃO: (1ª REPREENSÃO E PRISÃO ADMINISTRATIVA DE 60 MIN (CLAN 5)." }, { subtitle: "Conduta Militar", text: "PROIBIDO DESRESPEITAR UM SUPERIOR.\nPROIBIDO DESCUMPRIR UMA ORDEM DE UM SUPERIOR.\nPROIBIDO SER RUDE COM COLEGAS DE FARDA OU COM CIVIS.\nPUNIÇÃO: 1 REPREENSÃO, EM CASO DE PERSISTÊNCIA, EXONERAÇÃO\nASSOCIAÇÃO CRIMINOSA\nPUNIÇÃO: EXONERAÇÃO E BLACKLIST" }, { subtitle: "Patrulhas e Carro Particular", text: "PROIBIDO SAIR PARA PATRULHAR SOZINHO.\nPROIBIDO CONDUZIR PRESO EM CARRO PARTICULAR.\nPROIBIDO USAR VIATURA PARA USO PESSOAL.\nPUNIÇÃO: PODE VARIAR DE UMA ADVERTÊNCIA VERBAL A (1ª REPREENSÃO)." }] }, "Regras do Role Play": { title: "Regras do Role Play", content: [{ subtitle: "RP1 - Deathmatch (DM)", text: "CAUSAR DANO OU MATAR A UM PERSONAGEM SEM MOTIVOS DE RP. PENALIDADE: 20 MINUTOS NA PRISÃO." }, { subtitle: "RP3 - Poder Não RP (NP)", text: "USO DE CAPACidades FÍSICAS ALÉM DAS CARACTERÍSTICAS DO PERSONAGEM EM CARÁTER DE RP. PENALIDADE: 15 MINUTOS NA PRISÃO." }, { subtitle: "RP15 - Meta Gaming (MG)", text: "USAR INFORMAÇÕES DO MUNDO REAL NO RP. PENALIDADE: BLOQUEIO DO CHAT DE VOZ E TEXTO POR 20 MINUTOS A 20 MINUTOS DE PRISÃO." }, { subtitle: "RP6 - Abandono de RP", text: "QUALQUER TENTATIVA DE DESVIAR O PROCESSO DE RP PARA GANHO PESSOAL. ENTRAR EM UMA ZONA VERDE PARA ESCAPAR DE UMA PERSEGUIÇÃO ARMADA E EVITAR DANOS TAMBÉM SERÁ CONSIDERADO RECUSA DE RP. PENALIDADE: 30 A 60 MINUTOS DE PRISÃO." }, { subtitle: "RP10 - Repeat Kill (RK)", text: "MATAR OU PERSEGUIR UM JOGADOR APÓS SUA MORTE. RETORNAR AO LOCAL DA MORTE DENTRO DE 15 MINUTOS OU ATÉ O FINAL DA SITUAÇÃO EM QUE O PERSONAGEM MORREU. PENALIDADE: 90 MINUTOS DE PRISÃO." }, { subtitle: "RP11 - Não Observância de Áreas
  Protegidas", text: "COMETER CRIMES OU ATACAR JOGADORES EM ZONAS VERDES, ZONAS DE TRABALHO E VEÍCULOS DE TRABALHO. FICAR À ESPREITA PARA MATAR JOGADORES QUE SAEM DE ZONAS VERDES TAMBÉM É PROIBIDO. PENALidade: 30 A 60 MINUTOS DE PRISÃO." }, { subtitle: "Créditos", text: "Esse texto foi retirado do material de estudo feito pelo GENERAL FEDERAL LA REINA" }] } };
            const macrosData = [{ title: "01 - INICIANDO TURNO", content: "/flobby [REC/G.O.E] INICIANDO SUAS FUNÇÕES, A TOTAL QRV!!!" }, { title: "02 - APRESENTAÇÃO", content: "[REC/G.O.E] CONTINÊNCIA, SENHOR(A)! SE APRESENTANDO!" }, { title: "03 - ABORDAGENS", content: ["[POLÍCIA DE FORTUNA - G.O.E] CIDADÃO(Ã) ENCOSTE O VEÍCULO E VENHA PARA TRÁS DO PORTA MALAS DE COSTAS PARA MIM, POR GENTILEZA!", "[POLÍCIA DE FORTUNA - G.O.E] CIDADÃO, ABORDAGEM DE ROTINA, PERMANEÇA PARADO!", "[POLÍCIA DE FORTUNA - G.O.E] APRESENTE SEUS DOCUMENTOS!", "[POLÍCIA DE FORTUNA - G.O.E] TUDO CERTO CIDADÃO(Ã), ESTÁ LIBERADO(A)! OBRIGADO(A) PELA COLABORAÇÃO, TENHA UM ÓTIMO RP!", "[POLÍCIA DE FORTUNA - G.O.E] CIDADÃO(Ã), O SENHOR(A) ESTÁ PRESO(A)! O SENHOR(A) TEM O DIREITO DE PERMANECER CALADO(A), TUDO O QUE DISSER PODE E SERÁ USADO CONTRA VOCÊ!", "[POLÍCIA DE FORTUNA - G.O.E] CIDADÃO(Ã), O SENHOR(A) ESTÁ SENDO ALGEMADO(A) PARA PROSSEGUIRMOS COM A ABORDAGEM, PELA SEGURANÇA DE TODOS AO REDOR!", "[POLÍCIA DE FORTUNA - G.O.E] CIDADÃO(Ã), GUARDE SUA ARMA PARA A MINHA E A SUA SEGURANÇA. CASO CONTRÁRIO, ESTAREI LHE IMOBILIZANDO!"] }, { title: "04 - OPERAÇÕES", content: "[POLÍCIA DE FORTUNA - G.O.E] ATENÇÃO, AVISO ÚNICO! ESTAMOS EM OPERAÇÃO. LARGUEM SUAS ARMAS, CASO CONTRÁRIO, IREMOS INVADIR, PRENDER OU ABATER OS MESMOS!!!" }, { title: "05 - FARMS", content: ["[REC/G.O.E] LIDERANÇA/EQUIPE INICIANDO A OPERAÇÃO DE FARM. QUALQUER COISA, ESTOU À QRV.", "(PATRULHA)\n[POLÍCIA DE FORTUNA - G.O.E] ESTOU EM MISSÃO DE FARME. PEÇO QUE NÃO ATIREM EM MINHA VIATURA PARA EVITAR PROBLEMAS E PERMITIR QUE EU CONTINUE MEU TRABALHO SEM INTERFERÊNCIAS!!!", "(CONTRABANDO)\n[POLÍCIA DE FORTUNA - G.O.E] ESTOU EM MISSÃO DE CONTRABANDO. MEU CHECKPOINT ESTÁ LOCALIZADO DENTRO DO SEU QG. ESTAREI ENTRANDO PARA CONCLUIR A MISSÃO E ME RETIRAR LOGO APÓS. AGRADEÇO A COLABORAÇÃO E PEÇO QUE NÃO INTERFIRAM NA MINHA MISSÃO."] }, { title: "06 - PROCURADOS", content: ["[POLÍCIA DE FORTUNA - G.O.E] EM BUSCA DE PROCURADOS.", "[POLÍCIA DE FORTUNA - G.O.E] PARADO!!! SUAS CARACTERÍSTICAS BATEM COM AS DE UM PROCURADO."] }, { title: "07 - BLITZ", content: "[POLÍCIA DE FORTUNA - G.O.E] CIDADÃO(A), ENCOSTE O CARRO, ESTAMOS REALIZANDO UMA BLITZ NA CIDADE!!!" }, { title: "08 - DP", content: ["[POLÍCIA DE FORTUNA - G.O.E] SEJA BEM-VINDO À DELEGACIA DE FORTUNA, ESTOU À DISPOSIÇÃO PARA AJUDAR COM QUALQUER DÚVIDA. CASO O SENHOR(A) NÃO TENHA NADA A FAZER, PEÇO QUE SE RETIRE PARA EVITAR AGLOMERAÇÕES EM NOSSA RECEPÇÃO.", "[POLÍCIA DE FORTUNA - G.O.E] CIDADÃO(A), POR ORDEM DO ESTADO, CASO NÃO TENHA NADA PARA RESOLVER NO DEPARTAMENTO, POR FAVOR SE RETIRE. EM CASO DE DESOBEDIÊNCIA, ESTAREI TE IMOBILIZANDO, ALGEMANDO E CONDUZINDO POR QUEBRA DA ORDEM!", "[POLÍCIA DE FORTUNA - G.O.E] O PÁTIO DA DELEGACIA E O ESTACIONAMENTO NÃO SÃO ÁREAS PARA CONVERSAS E AGLOMERAÇÕES. PEÇO QUE CONCLUAM SEUS AFAZERES E SE RETIREM RAPIDAMENTE. CASO CONTRÁRIO, TEREI QUE CONDUZIR POR ARRUAÇA E DESACATO.", "[POLÍCIA DE FORTUNA - G.O.E] A DP DE FORTUNA ESTÁ COM RECRUTAMENTO ABERTO! ESTA É A OPORTUNIDADE DE CRESCER DENTRO DE UMA CORPORAÇÃO! VENHA FAZER PARTE DA POLÍCIA DE FORTUNA. REQUISITOS: NÍVEL 6, NÃO FAZER PARTE DE NENHUMA FACÇÃO, NÃO TER INFLAÇÕES."] }, { title: "09 - CENTRO DE TREINAMENTO", content: "[POLÍCIA DE FORTUNA - G.O.E] ESTA É UMA ÁREA RESTRITA. PEDIMOS QUE SE AFASTE IMEDIATAMENTE OU SERÁ DETIDO(A) POR DESACATO APÓS O TERCEIRO AVISO. CASO INVADA O LOCAL, SERÁ ABATIDO(A)." }, { title: "10 - HP", content: ["[POLÍCIA DE FORTUNA - G.O.E] CONFORME SOLICITADO, ESTAMOS QRV NO HOSPITAL DE FORTUNA PARA PRESTAR APOIO EM QUALQUER OCORRÊNCIA NA ÁREA. ESTAMOS À DISPOSIÇÃO.", "[POLÍCIA DE FORTUNA - G.O.E] SOLICITAMOS QUE GUARDEM SEUS ARMAMENTOS DENTRO DO HP (ÁREA SAFE). CASO CONTRÁRIO, SERÃO CONDUZIDOS POR PORTE ILEGAL DE ARMAS E DESACATO.", "[POLÍCIA DE FORTUNA - G.O.E] CIDADÃO(Ã), RETIRE-SE DO HOSPITAL APÓS O TRATAMENTO PARA EVITAR AGLOMERAÇÕES. CASO NÃO COLABORE, TEREI QUE CONDUZIR O(A) SENHOR(A) ATÉ O DEPARTAMENTO DE POLÍCIA.", "[POLÍCIA DE FORTUNA - G.O.E] A POLÍCIA DE FORTUNA TEM AUTORIZAÇÃO PARA AGIR DENTRO DO HOSPITAL EM CASO DE QUEBRA DE REGRAS. PEÇO A COLABORAÇÃO DE TODOS PARA MANTERMOS A ORDEM E A SEGURANÇA NO LOCAL!"] }, { title: "11 - ENCERRANDO O TURNO", content: "/ flobby [REC/G.O.E] INDO DE QTX! BOM TRABALHO A TODOS!" }];
            const quizQuestions = [{ question: "Qual o código Q para 'na escuta'?", options: ["QAP", "QRV", "QTH", "QSL"], answer: "QAP" }, { question: "É permitido usar veículo pessoal para atividades policiais?", options: ["Sim", "Não", "Apenas com autorização", "Apenas em emergências"], answer: "Não" }, { question: "Qual a penalidade para 'Deathmatch (DM)'?", options: ["15 minutos de prisão", "20 minutos de prisão", "30 minutos de prisão", "Advertência"], answer: "20 minutos de prisão" }, { question: "O que significa a Zona Verde?", options: ["Área de combate", "Área de eventos", "Área segura (safe zone)", "Área de farm"], answer: "Área segura (safe zone)" }, { question: "A partir de qual patente é permitido fazer farm de Contrabando?", options: ["Recruta", "Soldado", "Sargento", "Sargento Mor"], answer: "Sargento Mor" }, { question: "Qual violação corresponde a 'Desacato à autoridade'?", options: ["3.1", "3.2", "3.3", "3.4"], answer: "3.2" }, { question: "É permitido atirar em um suspeito rendido no chão?", options: ["Sim", "Não", "Apenas se ele for perigoso", "Apenas com ordem superior"], answer: "Não" }];

            let state = { user: null, activePage: 'tutoriais', preferences: { theme: 'theme-purple', font: 'font-main' }, aiMessages: [{ text: "Olá! Sou a General IA. Como posso ajudar?", sender: 'ai' }] };

            const mainContent = document.getElementById('main-content');
            const navMenu = document.getElementById('nav-menu');
            const userNicknameEl = document.getElementById('user-nickname');
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            const nicknameModal = document.getElementById('nickname-modal');
            const appContainer = document.getElementById('app-container');
            const questionnaireModal = document.getElementById('questionnaire-modal');
            const questionnaireCard = document.getElementById('questionnaire-card');

            // --- Fluxo de Inicialização ---
            function initializeAppFlow() {
                loadPreferences();
                const isCustomized = localStorage.getItem('isCustomized');
                const savedNickname = localStorage.getItem('goe_nickname');

                if (isCustomized && savedNickname) {
                    startApp(savedNickname);
                } else {
                    startQuestionnaire();
                }
            }

            function startApp(nickname) {
                questionnaireModal.style.display = 'none';
                nicknameModal.style.display = 'none';
                appContainer.style.display = 'block';
                
                state.user = { nickname: nickname };
                userNicknameEl.textContent = nickname;
                render();
            }

            // --- Questionário e Nickname ---
            let currentQuestion = 0;
            const questions = [
                { title: "Bem-vindo à Plataforma G.O.E", text: "Vamos personalizar sua experiência. Este rápido questionário ajudará a ajustar a interface ao seu gosto.", type: "intro", button: "Iniciar Personalização" },
                { title: "Escolha seu Tema de Cor", text: "Selecione a cor que mais lhe agrada. A interface se adaptará a ela.", type: "color", options: [ { value: 'theme-purple', label: 'Púrpura', color: '#6d28d9' }, { value: 'theme-blue', label: 'Azul', color: '#2563eb' }, { value: 'theme-green', label: 'Verde', color: '#16a34a' }, { value: 'theme-red', label: 'Vermelho', color: '#dc2626' } ] },
                { title: "Qual seu Estilo de Fonte?", text: "Prefere uma leitura mais moderna ou clássica?", type: "font", options: [ { value: 'font-main', label: 'Moderna (Inter)' }, { value: 'font-classic', label: 'Clássica (Roboto Slab)' } ] },
                { title: "Personalização Concluída!", text: "Suas preferências foram salvas. Você pode alterá-las a qualquer momento nas configurações.", type: "outro", button: "Concluir" }
            ];

            function startQuestionnaire() {
                currentQuestion = 0;
                renderQuestion();
                questionnaireModal.style.display = 'flex';
            }
            
            function renderQuestion() {
                const q = questions[currentQuestion];
                let optionsHtml = '';
                if (q.type === 'color') {
                    optionsHtml = `<div class="grid grid-cols-2 gap-4 mt-6">${q.options.map(opt => `<button data-value="${opt.value}" class="question-option p-4 rounded-lg text-white font-bold transition-transform hover:scale-105" style="background-color: ${opt.color};">${opt.label}</button>`).join('')}</div>`;
                } else if (q.type === 'font') {
                    optionsHtml = `<div class="grid grid-cols-2 gap-4 mt-6">${q.options.map(opt => `<button data-value="${opt.value}" class="question-option p-4 rounded-lg bg-gray-700 hover:bg-primary-600 transition-colors ${opt.value === 'font-classic' ? 'font-classic' : ''}">${opt.label}</button>`).join('')}</div>`;
                } else {
                    optionsHtml = `<button id="next-question-btn" class="w-full mt-6 bg-primary-600 hover:bg-primary-700 text-white font-bold py-3 rounded-lg transition-colors">${q.button}</button>`;
                }
                questionnaireCard.innerHTML = `<div class="question-step"><h2 class="text-3xl font-bold text-accent-400 mb-2">${q.title}</h2><p class="text-gray-300">${q.text}</p>${optionsHtml}</div>`;
                if (q.type === 'intro' || q.type === 'outro') {
                    document.getElementById('next-question-btn').addEventListener('click', nextQuestion);
                } else {
                    document.querySelectorAll('.question-option').forEach(btn => btn.addEventListener('click', (e) => {
                        const value = e.currentTarget.dataset.value;
                        if (q.type === 'color') state.preferences.theme = value;
                        if (q.type === 'font') state.preferences.font = value;
                        applyPreferences();
                        nextQuestion();
                    }));
                }
            }

            function nextQuestion() {
                currentQuestion++;
                if (currentQuestion < questions.length) {
                    renderQuestion();
                } else {
                    localStorage.setItem('isCustomized', 'true');
                    savePreferences();
                    questionnaireModal.style.display = 'none';
                    nicknameModal.style.display = 'flex';
                }
            }

            document.getElementById('nickname-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const nicknameInput = document.getElementById('nickname-input-modal');
                const nickname = nicknameInput.value.trim();
                if (nickname) {
                    localStorage.setItem('goe_nickname', nickname);
                    startApp(nickname);
                }
            });

      function savePreferences() { localStorage.setItem('userPreferences', JSON.stringify(state.preferences)); }
            function loadPreferences() { const saved = localStorage.getItem('userPreferences'); if (saved) state.preferences = JSON.parse(saved); applyPreferences(); }
            function applyPreferences() { document.body.className = `bg-gray-900 text-white ${state.preferences.theme} ${state.preferences.font}`; }

            function render() { renderSidebar(); renderPageContent(); }
            function renderSidebar() { const navItems = [ { id: 'tutoriais', label: 'Tutoriais', icon: icons.tutorial }, { id: 'macros', label: 'Macros', icon: icons.macros }, { id: 'estudo', label: 'Material de Estudo', icon: icons.book }, { id: 'provao', label: 'Provão G.O.E', icon: icons.quiz }, { id: 'ia', label: 'General IA', icon: icons.ai }, { id: 'settings', label: 'Configurações', icon: icons.settings }]; navMenu.innerHTML = navItems.map(item => `<li class="mb-2"><a href="#" data-page="${item.id}" class="nav-link flex items-center p-3 rounded-lg transition-all duration-200 ${state.activePage === item.id ? 'bg-primary-600 text-white shadow-md' : 'hover:bg-gray-700 hover:text-accent-300'}"><div class="mr-3">${item.icon}</div>${item.label}</a></li>`).join(''); document.querySelectorAll('.nav-link').forEach(link => link.addEventListener('click', handleNavClick)); }
            function renderPageContent() { const pageRenderer = pageRenderers[state.activePage]; if (pageRenderer) pageRenderer(); }
            function handleNavClick(e) { e.preventDefault(); state.activePage = e.currentTarget.dataset.page; render(); sidebar.classList.add('-translate-x-full'); sidebarOverlay.classList.add('hidden'); }
            document.getElementById('open-sidebar-btn').addEventListener('click', () => { sidebar.classList.remove('-translate-x-full'); sidebarOverlay.classList.remove('hidden'); });
            document.getElementById('close-sidebar-btn').addEventListener('click', () => { sidebar.classList.add('-translate-x-full'); sidebarOverlay.classList.add('hidden'); });
            sidebarOverlay.addEventListener('click', () => { sidebar.classList.add('-translate-x-full'); sidebarOverlay.classList.add('hidden'); });

            const pageRenderers = {
                macros: () => { mainContent.innerHTML = `<div class="p-4 md:p-6 page-content"><h2 class="text-3xl font-bold text-white mb-6">Macros G.O.E</h2><div class="space-y-6">${macrosData.map(macro => `<div class="bg-gray-800 rounded-lg shadow-lg p-4"><h3 class="text-xl font-semibold text-accent-400 mb-3">${macro.title}</h3>${Array.isArray(macro.content) ? macro.content.map(item => `<div class="bg-gray-700 p-3 rounded-md flex justify-between items-center mb-2"><pre class="text-gray-300 whitespace-pre-wrap text-sm flex-1">${item}</pre><button class="copy-btn ml-4 text-gray-400 hover:text-white transition-colors" data-text="${item.replace(/"/g, '&quot;')}">${icons.copy}</button></div>`).join('') : `<div class="bg-gray-700 p-3 rounded-md flex justify-between items-center"><pre class="text-gray-300 whitespace-pre-wrap text-sm flex-1">${macro.content}</pre><button class="copy-btn ml-4 text-gray-400 hover:text-white transition-colors" data-text="${macro.content.replace(/"/g, '&quot;')}">${icons.copy}</button></div>`}</div>`).join('')}</div></div>`; document.querySelectorAll('.copy-btn').forEach(btn => btn.addEventListener('click', handleMacroCopy)); },
                estudo: () => { mainContent.innerHTML = `<div class="p-4 md:p-6 page-content"><h2 class="text-3xl font-bold text-white mb-6">Material de Estudo</h2><div class="flex flex-col md:flex-row gap-6"><div class="w-full md:w-1/4"><div class="bg-gray-800 rounded-lg p-4 sticky top-20"><h3 class="font-bold text-accent-400 mb-4">Tópicos</h3><ul id="study-topics-list">${studyMaterialData.sumario.map(topic => `<li><a href="#" data-topic="${topic}" class="study-topic-link block p-2 rounded-md mb-1 transition-colors hover:bg-gray-700">${topic}</a></li>`).join('')}</ul></div></div><div class="w-full md:w-3/4" id="study-content-area"></div></div></div>`; document.querySelectorAll('.study-topic-link').forEach(link => link.addEventListener('click', handleStudyTopicClick)); renderStudyTopic(studyMaterialData.sumario[0]); },
                provao: () => { mainContent.innerHTML = `<div id="provao-container" class="p-4 md:p-6 max-w-2xl mx-auto page-content"></div>`; startQuiz(); },
                ia: () => { mainContent.innerHTML = `<div class="p-4 md:p-6 h-full flex flex-col max-w-3xl mx-auto page-content"><h2 class="text-3xl font-bold text-white mb-6 text-center">General IA</h2><div class="flex-grow bg-gray-800 rounded-lg shadow-lg flex flex-col" style="height: calc(100vh - 200px);"><div id="ai-messages" class="flex-grow p-4 overflow-y-auto"></div><form id="ai-form" class="p-4 border-t border-gray-700 flex items-center gap-2"><input type="text" id="ai-input" placeholder="Pergunte sobre o material de estudo..." class="flex-grow bg-gray-700 text-white p-3 rounded-full border border-gray-600 focus:ring-2 ring-accent-400 focus:outline-none" /><button type="submit" id="ai-submit-btn" class="bg-primary-600 hover:bg-primary-700 text-white p-3 rounded-full transition-colors disabled:bg-gray-500">${icons.send}</button></form></div></div>`; document.getElementById('ai-form').addEventListener('submit', handleAiSubmit); renderAiMessages(); },
                settings: () => { mainContent.innerHTML = `<div class="p-4 md:p-6 max-w-2xl mx-auto page-content"><h2 class="text-3xl font-bold text-white mb-6 text-center">Configurações</h2><div class="bg-gray-800 p-6 rounded-lg shadow-lg space-y-4"><div><label for="nickname-input" class="block mb-2 text-sm font-medium text-accent-300">Seu Apelido (Nome no RP)</label><input type="text" id="nickname-input" value="${state.user?.nickname || ''}" class="w-full bg-gray-700 text-white p-3 rounded-md border border-gray-600 focus:ring-2 ring-accent-400 focus:outline-none" /></div><button id="save-settings-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition-colors">Salvar Alterações</button><p id="settings-message" class="text-center h-4 mt-4"></p><button id="redo-questionnaire-btn" class="w-full mt-4 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 rounded-lg transition-colors">Refazer Personalização</button></div></div>`; document.getElementById('save-settings-btn').addEventListener('click', handleSettingsSave); document.getElementById('redo-questionnaire-btn').addEventListener('click', startQuestionnaire); },
                tutoriais: () => { 
                    mainContent.innerHTML = `<div class="p-4 md:p-6 page-content">
                        <h2 class="text-3xl font-bold text-white mb-6">Tutoriais</h2>
                        <div id="tutorials-container" class="space-y-8">
                            <div class="bg-gray-800 p-4 rounded-lg">
                                <h3 class="text-xl font-bold text-accent-400 mb-4">Como Utilizar o Site</h3>
                                <div class="video-container"><iframe src="https://www.youtube.com/embed/kcH8xE5jE-Y" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
                            </div>
                            <div class="bg-gray-800 p-4 rounded-lg">
                                <h3 class="text-xl font-bold text-accent-400 mb-4">Como colocar Macros</h3>
                                <div class="video-container"><iframe src="https://www.youtube.com/embed/WezLzaZZIX0" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
                            </div>
                            <div class="bg-gray-800 p-4 rounded-lg">
                                <h3 class="text-xl font-bold text-accent-400 mb-4">Como aplicar violações</h3>
                                <div class="video-container"><iframe src="https://www.youtube.com/embed/jSZcyigRjng" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
                            </div>
                        </div>
                    </div>`;
                }
            };

            function handleMacroCopy(e) { const button = e.currentTarget; const textToCopy = button.dataset.text; const textArea = document.createElement("textarea"); textArea.value = textToCopy; textArea.style.position = "fixed"; textArea.style.left = "-9999px"; document.body.appendChild(textArea); textArea.select(); try { document.execCommand('copy'); const originalContent = button.innerHTML; button.innerHTML = 'Copiado!'; button.classList.add('text-green-400'); setTimeout(() => { button.innerHTML = originalContent; button.classList.remove('text-green-400'); }, 2000); } catch (err) { console.error('Falha ao copiar texto: ', err); } document.body.removeChild(textArea); }
            function
renderStudyTopic(topic) { const contentArea = document.getElementById('study-content-area'); if (!contentArea) return; const topicData = studyMaterialData[topic]; const activeLink = document.querySelector(`.study-topic-link[data-topic="${topic}"]`); document.querySelectorAll('.study-topic-link').forEach(l => l.classList.remove('bg-primary-600', 'text-white')); if(activeLink) activeLink.classList.add('bg-primary-600', 'text-white'); contentArea.innerHTML = `<div class="bg-gray-800 rounded-lg shadow-lg p-6 animate-fade-in"><h2 class="text-2xl font-bold text-accent-400 mb-4 border-b-2 border-primary-500 pb-2">${topicData.title}</h2><div class="space-y-4 text-gray-300">${topicData.content.map(item => `<div>${item.subtitle ? `<h4 class="text-lg font-semibold text-yellow-400 mb-2">${item.subtitle}</h4>` : ''}<p class="whitespace-pre-wrap leading-relaxed">${item.text}</p></div>`).join('')}</div></div>`; }
            function handleStudyTopicClick(e) { e.preventDefault(); renderStudyTopic(e.currentTarget.dataset.topic); }
            let quizState = {};
            function startQuiz() { quizState = { shuffledQuestions: [...quizQuestions].sort(() => Math.random() - 0.5), currentQuestionIndex: 0, selectedAnswers: {}, score: 0 }; renderQuiz(); }
            function renderQuiz() { const container = document.getElementById('provao-container'); if (!container) return; const { shuffledQuestions, currentQuestionIndex, selectedAnswers, score } = quizState; if (currentQuestionIndex >= shuffledQuestions.length) { const percentage = Math.round((score / shuffledQuestions.length) * 100); container.innerHTML = `<div class="text-center"><h2 class="text-3xl font-bold text-white mb-4">Resultado do Provão</h2><div class="bg-gray-800 p-6 rounded-lg shadow-lg"><p class="text-5xl font-bold mb-4 ${percentage >= 70 ? 'text-green-400' : 'text-red-400'}">${percentage}%</p><p class="text-xl text-white mb-6">Você acertou ${score} de ${shuffledQuestions.length} questões.</p><div class="space-y-4 text-left">${shuffledQuestions.map((q, index) => `<div class="p-3 rounded-md ${selectedAnswers[index] === q.answer ? 'bg-green-900 bg-opacity-50' : 'bg-red-900 bg-opacity-50'}"><p class="font-bold text-white">${q.question}</p><p class="text-sm text-gray-300">Sua resposta: ${selectedAnswers[index] || "N/A"}</p><p class="text-sm text-green-400">Resposta correta: ${q.answer}</p></div>`).join('')}</div><button id="restart-quiz-btn" class="mt-6 bg-primary-600 hover:bg-primary-700 text-white font-bold py-2 px-6 rounded-lg transition-colors">Tentar Novamente</button></div></div>`; document.getElementById('restart-quiz-btn').addEventListener('click', startQuiz); } else { const currentQuestion = shuffledQuestions[currentQuestionIndex]; container.innerHTML = `<h2 class="text-3xl font-bold text-white mb-6 text-center">Provão G.O.E</h2><div class="bg-gray-800 p-6 rounded-lg shadow-lg"><p class="text-sm text-gray-400 mb-2">Questão ${currentQuestionIndex + 1} de ${shuffledQuestions.length}</p><h3 class="text-xl text-white mb-6">${currentQuestion.question}</h3><div class="space-y-3">${currentQuestion.options.map(option => `<button data-option="${option}" class="quiz-option-btn w-full text-left p-4 rounded-lg transition-colors border-2 ${selectedAnswers[currentQuestionIndex] === option ? 'bg-primary-600 border-accent-400 text-white' : 'bg-gray-700 border-gray-600 hover:bg-gray-600 text-gray-300'}">${option}</button>`).join('')}</div><button id="next-quiz-btn" class="w-full mt-6 bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition-colors" ${!selectedAnswers[currentQuestionIndex] ? 'disabled' : ''}>${currentQuestionIndex < shuffledQuestions.length - 1 ? 'Próxima Questão' : 'Finalizar Prova'}</button></div>`; document.querySelectorAll('.quiz-option-btn').forEach(btn => btn.addEventListener('click', handleQuizAnswer)); document.getElementById('next-quiz-btn').addEventListener('click', handleQuizNext); } }
            function handleQuizAnswer(e) { quizState.selectedAnswers[quizState.currentQuestionIndex] = e.currentTarget.dataset.option; renderQuiz(); }
            function handleQuizNext() { if (quizState.selectedAnswers[quizState.currentQuestionIndex] === quizState.shuffledQuestions[quizState.currentQuestionIndex].answer) { quizState.score++; } quizState.currentQuestionIndex++; renderQuiz(); }
            function renderAiMessages() { const container = document.getElementById('ai-messages'); if(!container) return; container.innerHTML = state.aiMessages.map(msg => { const content = msg.loading ? `<div class="flex items-center space-x-1"><div class="w-2 h-2 bg-accent-300 rounded-full animate-pulse"></div><div class="w-2 h-2 bg-accent-300 rounded-full animate-pulse delay-150"></div><div class="w-2 h-2 bg-accent-300 rounded-full animate-pulse delay-300"></div></div>` : `<p class="whitespace-pre-wrap">${msg.text}</p>`; return `<div class="flex items-end gap-2 mb-4 ${msg.sender === 'ai' ? 'justify-start' : 'justify-end'}">${msg.sender === 'ai' ? `<div class="w-8 h-8 rounded-full bg-primary-500 flex items-center justify-center font-bold text-white flex-shrink-0">IA</div>` : ''}<div class="max-w-md p-3 rounded-lg ${msg.sender === 'ai' ? 'bg-gray-700 text-gray-200' : 'bg-primary-600 text-white'}">${content}</div></div>`; }).join(''); container.scrollTop = container.scrollHeight; }
            async function handleAiSubmit(e) { e.preventDefault(); const inputEl = document.getElementById('ai-input'); const submitBtn = document.getElementById('ai-submit-btn'); const input = inputEl.value.trim(); if (!input) return; state.aiMessages.push({ text: input, sender: 'user' }); inputEl.value = ''; submitBtn.disabled = true; state.aiMessages.push({ text: '...', sender: 'ai', loading: true }); renderAiMessages(); try { const videoContext = `Contexto dos Vídeos Tutoriais: - Tutorial "Como Utilizar o Site": O site possui um menu lateral com seções como Tutoriais, Macros, Material de Estudo, Provão, IA e Configurações. O usuário pode personalizar cores e fontes nas configurações. - Tutorial "Como colocar Macros": O usuário deve ir para a seção "Macros", encontrar o texto desejado, clicar no botão de copiar e colar no jogo. - Tutorial "Como aplicar violações": O usuário deve consultar o "Material de Estudo" para encontrar o código correto da violação antes de aplicá-la no jogo.`; const context = "Contexto do Material de Estudo da G.O.E:\n" + Object.values(studyMaterialData).filter(v => typeof v === 'object' && v.content).flatMap(topic => topic.content.map(item => `${topic.title} - ${item.subtitle || ''}: ${item.text}`)).join('\n\n') + videoContext; const prompt = `${context}\n\nCom base no contexto acima, responda a seguinte pergunta do usuário de forma concisa e direta, como um assistente prestativo:\n\nPergunta: ${input}\n\nResposta:`; const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] }; const apiKey = ""; const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`; const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) }); if (!response.ok) throw new Error(`API error: ${response.status} ${response.statusText}`); const result = await response.json(); state.aiMessages.pop(); const aiText = result.candidates?.[0]?.content?.parts?.[0]?.text || "Não consegui processar a resposta. Tente novamente."; state.aiMessages.push({ text: aiText, sender: 'ai' }); } catch (error) { console.error("Erro na chamada da IA:", error); state.aiMessages.pop(); state.aiMessages.push({ text: "Desculpe, ocorreu um erro.", sender: 'ai' }); } finally { submitBtn.disabled = false; renderAiMessages(); } }
            function handleSettingsSave() { const nicknameInput = document.getElementById('nickname-input'); const messageEl = document.getElementById('settings-message'); const newNickname = nicknameInput.value.trim(); if (!newNickname) { messageEl.textContent = 'Apelido não pode estar vazio.'; return; } messageEl.textContent = 'Salvando...'; state.user.nickname = newNickname; localStorage.setItem('goe_nickname', newNickname); userNicknameEl.textContent = newNickname; messageEl.textContent = 'Apelido salvo com sucesso!'; messageEl.className = 'text-center text-green-400 mt-4 h-4'; setTimeout(() => { messageEl.textContent = '' }, 3000); }

            initializeAppFlow();
        });
    </script>
</body>
</html>

